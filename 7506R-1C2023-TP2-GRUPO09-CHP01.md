---
jupyter:
  jupytext:
    cell_metadata_filter: -all
    formats: ipynb,md
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.5
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

```python
try:
  import google.colab
  IN_COLAB = True
except:
  IN_COLAB = False
import pandas as pd 
import numpy as np

import sklearn
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn.pipeline import make_pipeline
from sklearn.model_selection import train_test_split

from os.path import exists

import nltk
stopwords = nltk.corpus.stopwords.words('spanish')

import tensorflow as tf

from tensorflow import keras
from keras.preprocessing.text import one_hot, Tokenizer
from keras.models import Sequential
from keras.layers.core import Activation, Dropout, Dense
from keras.layers import Flatten, GlobalMaxPooling1D, Embedding, Conv1D, LSTM, TextVectorization
from keras_preprocessing.sequence import pad_sequences
```

```python
SEED=9
```

```python
reviewDfOriginal = pd.read_csv("./review_train.csv")
reviewDf = reviewDfOriginal.copy()
```

```python
review_pruebasOriginal = pd.read_csv("./review_test.csv")
review_pruebas = review_pruebasOriginal.copy()
```

```python
reviewDf = reviewDf.drop(["ID"],  axis='columns', inplace=False)
reviewDf
```

```python
reviewDf_x = reviewDf.drop(["sentimiento"],  axis='columns', inplace=False)

reviewDf_y = reviewDf['sentimiento'].copy()

x_train, x_test, y_train, y_test = train_test_split(reviewDf_x,
                                                    reviewDf_y,
                                                    test_size=0.30,
                                                    random_state=SEED,
                                                    shuffle=True
                                                    )
```

# Bayes Naive

```python
modeloBayesNaive = make_pipeline(TfidfVectorizer(), MultinomialNB())
```

```python
if not exists('submissions/TP2/naiveBayes-0.csv'):
    modeloBayesNaive.fit(x_train.review_es, y_train)
    prediccion = modeloBayesNaive.predict(review_pruebas.review_es)
    df_submission = pd.DataFrame({'id': review_pruebasOriginal['ID'], 'sentimiento': prediccion})
    df_submission.to_csv('submissions/naiveBayes-0.csv', index=False)
```

# Random Forest


# XGBoost



# Red Neuronal


Transformamos la columna objetivo de "positivo" y "negativo" a 0 y 1

```python
y = reviewDf['sentimiento']
y = np.array(list(map(lambda x: 1 if x=="positivo" else 0, y)))
y
```
## Tokenizador


Creamos el tokenizador. TextVectorization() (https://www.tensorflow.org/api_docs/python/tf/keras/layers/TextVectorization), le asigna un valor numerico a cada una de las palabras de nuestro vocabulario

```python
tokenizador = TextVectorization()
```

## Pre procesamiento


Antes de tokenizar las reviews, vamos a hacer un proceso de pre procesamiento para elimiar palabras innecesarias, como preprosiciones 

```python
tokenizador.adapt(reviewDf["review_es"])
```

```python
len(tokenizador.get_vocabulary())#[995:999]
```

```python
model = tf.keras.models.Sequential()
model.add(tf.keras.Input(shape=(1,), dtype=tf.string))

model.add(tokenizador)

```

```python
model.predict(["humano disfrutar jamon"])

```

```python

```
